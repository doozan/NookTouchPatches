diff --git a/com/android/server/status/BNGossamerQuickNavbar.smali b/com/android/server/status/BNGossamerQuickNavbar.smali
index 4817821..b4f42b9 100644
--- a/com/android/server/status/BNGossamerQuickNavbar.smali
+++ b/com/android/server/status/BNGossamerQuickNavbar.smali
@@ -621,6 +621,13 @@
     .line 89
     invoke-direct {p0}, Lcom/android/server/status/BNGossamerQuickNavbar;->setOnClickListeners()V
 
+### Mod Start
+###
+### Replace custom button icons, this should be called at the end of Init()
+###
+    invoke-virtual {p0}, Lcom/android/server/status/BNGossamerQuickNavbar;->replaceQuicknavIcons()V
+### Mod End
+
     .line 90
     return-void
 
@@ -664,6 +671,38 @@
     goto :goto_2c
 .end method
 
+### Mod Start
+###
+### Function to replace custom button icons
+### 
+
+.method public replaceQuicknavIcons()V
+    .registers 4
+
+    iget-object v0, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mContext:Landroid/content/Context;
+
+    iget-object v1, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mAppHome:Landroid/widget/ImageView;
+    invoke-static {v0, v1}, Lcom/android/server/status/ModUtils;->replaceQuicknavIcon(Landroid/content/Context;Landroid/widget/ImageView;)V
+
+    iget-object v1, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mAppLibrary:Landroid/widget/ImageView;
+    invoke-static {v0, v1}, Lcom/android/server/status/ModUtils;->replaceQuicknavIcon(Landroid/content/Context;Landroid/widget/ImageView;)V
+
+    iget-object v1, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mAppShop:Landroid/widget/ImageView;
+    invoke-static {v0, v1}, Lcom/android/server/status/ModUtils;->replaceQuicknavIcon(Landroid/content/Context;Landroid/widget/ImageView;)V
+
+    iget-object v1, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mAppSearch:Landroid/widget/ImageView;
+    invoke-static {v0, v1}, Lcom/android/server/status/ModUtils;->replaceQuicknavIcon(Landroid/content/Context;Landroid/widget/ImageView;)V
+
+    iget-object v1, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mGlowLight:Landroid/widget/ImageView;
+    invoke-static {v0, v1}, Lcom/android/server/status/ModUtils;->replaceQuicknavIcon(Landroid/content/Context;Landroid/widget/ImageView;)V
+
+    iget-object v1, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mAppSettings:Landroid/widget/ImageView;
+    invoke-static {v0, v1}, Lcom/android/server/status/ModUtils;->replaceQuicknavIcon(Landroid/content/Context;Landroid/widget/ImageView;)V
+
+	return-void
+.end method
+### Mod End
+
 .method public onClick(Landroid/view/View;)V
     .registers 13
     .parameter "v"
@@ -676,6 +715,32 @@
 
     move-result v4
 
+### Mod Start
+###
+### Override the quicknav buttons
+###
+### This should run near the start of onClick(), immediately after
+### getId() is read into v4
+###
+### if ( ModUtils.OnButtonClick( QuickNavbar.ctx, buttonId ) )
+###   mService.hideQuicknav()
+###   return;
+### }
+
+    iget-object v0, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->ctx:Landroid/content/Context;
+    invoke-static {v0, v4}, Lcom/android/server/status/ModUtils;->OnButtonClick(Landroid/content/Context;I)Z
+
+    move-result v0
+    if-eqz v0, :cond_mod1
+
+    iget-object v0, p0, Lcom/android/server/status/BNGossamerQuickNavbar;->mService:Lcom/android/server/status/StatusBarService;
+    invoke-virtual {v0, v10}, Lcom/android/server/status/StatusBarService;->hideQuicknav(Z)V
+
+    return-void
+
+    :cond_mod1
+### Mod End
+
     .line 107
     .local v4, id:I
     const/4 v0, 0x0
@@ -860,6 +925,22 @@
     .parameter "inStore"
 
     .prologue
+
+### Mod Start
+###
+###   If the shop button is overloaded, don't update the "in store" icon
+###
+    iget-object v0, p0, Lcom/android/server/status/StatusBarService;->mContext:Landroid/content/Context;
+    invoke-static {v0}, Lcom/android/server/status/ModUtils;->overrideShopButton(Landroid/content/Context;)Z
+
+    move-result v0
+    if-eqz v0, :cond_mod1
+
+    return-void
+
+    :cond_mod1
+### Mod End
+
     .line 165
     if-eqz p1, :cond_13
 
diff --git a/com/android/server/status/ModUtils$1.smali b/com/android/server/status/ModUtils$1.smali
new file mode 100644
index 0000000..6973ecb
--- /dev/null
+++ b/com/android/server/status/ModUtils$1.smali
@@ -0,0 +1,74 @@
+.class Lcom/android/server/status/ModUtils$1;
+.super Ljava/lang/Object;
+.source "ModUtils.java"
+
+# interfaces
+.implements Ljava/lang/Runnable;
+
+
+# annotations
+.annotation system Ldalvik/annotation/EnclosingMethod;
+    value = Lcom/android/server/status/ModUtils;->doAction(Landroid/content/Context;Ljava/lang/String;)Z
+.end annotation
+
+.annotation system Ldalvik/annotation/InnerClass;
+    accessFlags = 0x0
+    name = null
+.end annotation
+
+
+# instance fields
+.field private final synthetic val$action:Ljava/lang/String;
+
+.field private final synthetic val$context:Landroid/content/Context;
+
+
+# direct methods
+.method constructor <init>(Landroid/content/Context;Ljava/lang/String;)V
+    .registers 3
+    .parameter
+    .parameter
+
+    .prologue
+    .line 1
+    iput-object p1, p0, Lcom/android/server/status/ModUtils$1;->val$context:Landroid/content/Context;
+
+    iput-object p2, p0, Lcom/android/server/status/ModUtils$1;->val$action:Ljava/lang/String;
+
+    .line 279
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
+
+
+# virtual methods
+.method public run()V
+    .registers 4
+
+    .prologue
+    .line 281
+    iget-object v0, p0, Lcom/android/server/status/ModUtils$1;->val$context:Landroid/content/Context;
+
+    iget-object v1, p0, Lcom/android/server/status/ModUtils$1;->val$action:Ljava/lang/String;
+
+    const-string v2, "KEY:"
+
+    invoke-virtual {v2}, Ljava/lang/String;->length()I
+
+    move-result v2
+
+    invoke-virtual {v1, v2}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v1
+
+    invoke-static {v1}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+
+    move-result v1
+
+    #calls: Lcom/android/server/status/ModUtils;->doKey(Landroid/content/Context;I)Z
+    invoke-static {v0, v1}, Lcom/android/server/status/ModUtils;->access$0(Landroid/content/Context;I)Z
+
+    .line 282
+    return-void
+.end method
diff --git a/com/android/server/status/ModUtils.smali b/com/android/server/status/ModUtils.smali
new file mode 100644
index 0000000..c49edf3
--- /dev/null
+++ b/com/android/server/status/ModUtils.smali
@@ -0,0 +1,1985 @@
+.class public Lcom/android/server/status/ModUtils;
+.super Ljava/lang/Object;
+.source "ModUtils.java"
+
+
+# static fields
+.field private static final QUICKNAV_GLOWLIGHT:I = 0x102019b
+
+.field private static final QUICKNAV_HOME:I = 0x1020196
+
+.field private static final QUICKNAV_LIBRARY:I = 0x1020197
+
+.field private static final QUICKNAV_SEARCH:I = 0x1020199
+
+.field private static final QUICKNAV_SETTINGS:I = 0x102019a
+
+.field private static final QUICKNAV_SHOP:I = 0x1020198
+
+.field private static final STATUSBAR_BACK:I = 0x1020220
+
+.field private static final STATUSBAR_GLOWLIGHT:I = 0x1020225
+
+.field private static final STATUSBAR_MENU:I = 0x1020221
+
+.field private static final STATUSBAR_NOTIFY:I = 0x1020223
+
+.field private static final STATUSBAR_READNOW:I = 0x1020222
+
+.field private static final TAG:Ljava/lang/String; = "NookMod"
+
+.field private static final VERSION:Ljava/lang/String; = "0.2.0"
+
+
+# direct methods
+.method public constructor <init>()V
+    .registers 1
+
+    .prologue
+    .line 28
+    invoke-direct {p0}, Ljava/lang/Object;-><init>()V
+
+    return-void
+.end method
+
+.method public static OnButtonClick(Landroid/content/Context;I)Z
+    .registers 9
+    .parameter "context"
+    .parameter "id"
+
+    .prologue
+    const/4 v3, 0x0
+
+    .line 80
+    invoke-static {p1}, Lcom/android/server/status/ModUtils;->getButtonName(I)Ljava/lang/String;
+
+    move-result-object v1
+
+    .line 81
+    .local v1, buttonName:Ljava/lang/String;
+    if-eqz v1, :cond_d
+
+    invoke-virtual {v1}, Ljava/lang/String;->length()I
+
+    move-result v4
+
+    if-nez v4, :cond_22
+
+    .line 83
+    :cond_d
+    const-string v4, "NookMod"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    const-string v6, "OnButtonClick() Unknown button id = "
+
+    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-static {v4, v5}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
+
+    .line 94
+    :cond_21
+    :goto_21
+    return v3
+
+    .line 88
+    :cond_22
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v2
+
+    .line 89
+    .local v2, resolver:Landroid/content/ContentResolver;
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string v5, "mod."
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    const-string v5, ".cmd"
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v2, v4}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v0
+
+    .line 91
+    .local v0, action:Ljava/lang/String;
+    if-eqz v0, :cond_21
+
+    invoke-virtual {v0}, Ljava/lang/String;->length()I
+
+    move-result v4
+
+    if-eqz v4, :cond_21
+
+    .line 94
+    invoke-static {p0, v0}, Lcom/android/server/status/ModUtils;->doAction(Landroid/content/Context;Ljava/lang/String;)Z
+
+    move-result v3
+
+    goto :goto_21
+.end method
+
+.method static synthetic access$0(Landroid/content/Context;I)Z
+    .registers 3
+    .parameter
+    .parameter
+
+    .prologue
+    .line 350
+    invoke-static {p0, p1}, Lcom/android/server/status/ModUtils;->doKey(Landroid/content/Context;I)Z
+
+    move-result v0
+
+    return v0
+.end method
+
+.method public static alwaysShowStatusIcons(Landroid/content/Context;)Z
+    .registers 5
+    .parameter "context"
+
+    .prologue
+    const/4 v2, 0x0
+
+    .line 98
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v1
+
+    .line 100
+    .local v1, resolver:Landroid/content/ContentResolver;
+    :try_start_5
+    const-string v3, "mod.option.always_show_status_icons"
+
+    invoke-static {v1, v3}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;)I
+    :try_end_a
+    .catch Landroid/provider/Settings$SettingNotFoundException; {:try_start_5 .. :try_end_a} :catch_f
+
+    move-result v3
+
+    if-lez v3, :cond_e
+
+    const/4 v2, 0x1
+
+    .line 102
+    :cond_e
+    :goto_e
+    return v2
+
+    .line 101
+    :catch_f
+    move-exception v0
+
+    .line 102
+    .local v0, e:Landroid/provider/Settings$SettingNotFoundException;
+    goto :goto_e
+.end method
+
+.method public static disableDragToUnlock(Landroid/content/Context;)Z
+    .registers 5
+    .parameter "context"
+
+    .prologue
+    const/4 v2, 0x0
+
+    .line 107
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v1
+
+    .line 109
+    .local v1, resolver:Landroid/content/ContentResolver;
+    :try_start_5
+    const-string v3, "mod.option.disable_drag_to_unlock"
+
+    invoke-static {v1, v3}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;)I
+    :try_end_a
+    .catch Landroid/provider/Settings$SettingNotFoundException; {:try_start_5 .. :try_end_a} :catch_f
+
+    move-result v3
+
+    if-lez v3, :cond_e
+
+    const/4 v2, 0x1
+
+    .line 111
+    :cond_e
+    :goto_e
+    return v2
+
+    .line 110
+    :catch_f
+    move-exception v0
+
+    .line 111
+    .local v0, e:Landroid/provider/Settings$SettingNotFoundException;
+    goto :goto_e
+.end method
+
+.method public static doAction(Landroid/content/Context;Ljava/lang/String;)Z
+    .registers 6
+    .parameter "context"
+    .parameter "action"
+
+    .prologue
+    const/4 v0, 0x0
+
+    .line 266
+    if-eqz p1, :cond_9
+
+    invoke-virtual {p1}, Ljava/lang/String;->length()I
+
+    move-result v1
+
+    if-nez v1, :cond_a
+
+    .line 294
+    :cond_9
+    :goto_9
+    return v0
+
+    .line 269
+    :cond_a
+    const-string v1, "PACKAGE:"
+
+    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_21
+
+    .line 270
+    const-string v0, "PACKAGE:"
+
+    invoke-virtual {v0}, Ljava/lang/String;->length()I
+
+    move-result v0
+
+    invoke-virtual {p1, v0}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v0
+
+    invoke-static {p0, v0}, Lcom/android/server/status/ModUtils;->doPackage(Landroid/content/Context;Ljava/lang/String;)Z
+
+    move-result v0
+
+    goto :goto_9
+
+    .line 272
+    :cond_21
+    const-string v1, "ACTIVITY:"
+
+    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_38
+
+    .line 273
+    const-string v0, "ACTIVITY:"
+
+    invoke-virtual {v0}, Ljava/lang/String;->length()I
+
+    move-result v0
+
+    invoke-virtual {p1, v0}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v0
+
+    invoke-static {p0, v0}, Lcom/android/server/status/ModUtils;->doActivity(Landroid/content/Context;Ljava/lang/String;)Z
+
+    move-result v0
+
+    goto :goto_9
+
+    .line 275
+    :cond_38
+    const-string v1, "BROADCAST:"
+
+    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_4f
+
+    .line 276
+    const-string v0, "BROADCAST:"
+
+    invoke-virtual {v0}, Ljava/lang/String;->length()I
+
+    move-result v0
+
+    invoke-virtual {p1, v0}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v0
+
+    invoke-static {p0, v0}, Lcom/android/server/status/ModUtils;->doBroadcast(Landroid/content/Context;Ljava/lang/String;)Z
+
+    move-result v0
+
+    goto :goto_9
+
+    .line 278
+    :cond_4f
+    const-string v1, "KEY:"
+
+    invoke-virtual {p1, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_66
+
+    .line 279
+    new-instance v0, Ljava/lang/Thread;
+
+    new-instance v1, Lcom/android/server/status/ModUtils$1;
+
+    invoke-direct {v1, p0, p1}, Lcom/android/server/status/ModUtils$1;-><init>(Landroid/content/Context;Ljava/lang/String;)V
+
+    invoke-direct {v0, v1}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V
+
+    .line 283
+    invoke-virtual {v0}, Ljava/lang/Thread;->start()V
+
+    .line 284
+    const/4 v0, 0x1
+
+    goto :goto_9
+
+    .line 287
+    :cond_66
+    const-string v1, "QUICKNAV"
+
+    invoke-virtual {p1, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_73
+
+    .line 288
+    invoke-static {p0}, Lcom/android/server/status/ModUtils;->doToggleQuicknav(Landroid/content/Context;)Z
+
+    move-result v0
+
+    goto :goto_9
+
+    .line 290
+    :cond_73
+    const-string v1, "GLOWLIGHT"
+
+    invoke-virtual {p1, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v1
+
+    if-eqz v1, :cond_80
+
+    .line 291
+    invoke-static {p0}, Lcom/android/server/status/ModUtils;->doToggleGlowlight(Landroid/content/Context;)Z
+
+    move-result v0
+
+    goto :goto_9
+
+    .line 293
+    :cond_80
+    const-string v1, "NookMod"
+
+    new-instance v2, Ljava/lang/StringBuilder;
+
+    const-string v3, "doAction() unknown action: "
+
+    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v2
+
+    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v2
+
+    invoke-static {v1, v2}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_9
+.end method
+
+.method private static doActivity(Landroid/content/Context;Ljava/lang/String;)Z
+    .registers 3
+    .parameter "context"
+    .parameter "command"
+
+    .prologue
+    .line 335
+    if-eqz p1, :cond_8
+
+    invoke-virtual {p1}, Ljava/lang/String;->length()I
+
+    move-result v0
+
+    if-nez v0, :cond_a
+
+    .line 336
+    :cond_8
+    const/4 v0, 0x0
+
+    .line 339
+    :goto_9
+    return v0
+
+    .line 338
+    :cond_a
+    invoke-static {p1}, Lcom/android/server/status/ModUtils;->getIntentFromString(Ljava/lang/String;)Landroid/content/Intent;
+
+    move-result-object v0
+
+    invoke-virtual {p0, v0}, Landroid/content/Context;->startActivity(Landroid/content/Intent;)V
+
+    .line 339
+    const/4 v0, 0x1
+
+    goto :goto_9
+.end method
+
+.method private static doBroadcast(Landroid/content/Context;Ljava/lang/String;)Z
+    .registers 3
+    .parameter "context"
+    .parameter "command"
+
+    .prologue
+    .line 343
+    if-eqz p1, :cond_8
+
+    invoke-virtual {p1}, Ljava/lang/String;->length()I
+
+    move-result v0
+
+    if-nez v0, :cond_a
+
+    .line 344
+    :cond_8
+    const/4 v0, 0x0
+
+    .line 347
+    :goto_9
+    return v0
+
+    .line 346
+    :cond_a
+    invoke-static {p1}, Lcom/android/server/status/ModUtils;->getIntentFromString(Ljava/lang/String;)Landroid/content/Intent;
+
+    move-result-object v0
+
+    invoke-virtual {p0, v0}, Landroid/content/Context;->sendBroadcast(Landroid/content/Intent;)V
+
+    .line 347
+    const/4 v0, 0x1
+
+    goto :goto_9
+.end method
+
+.method private static doKey(Landroid/content/Context;I)Z
+    .registers 13
+    .parameter "context"
+    .parameter "keycode"
+
+    .prologue
+    const/4 v5, 0x1
+
+    const/4 v4, 0x0
+
+    .line 351
+    if-gtz p1, :cond_5
+
+    .line 373
+    :goto_4
+    return v4
+
+    .line 360
+    :cond_5
+    :try_start_5
+    const-string v6, "android.os.ServiceManager"
+
+    invoke-static {v6}, Ljava/lang/Class;->forName(Ljava/lang/String;)Ljava/lang/Class;
+
+    move-result-object v6
+
+    const-string v7, "getService"
+
+    const/4 v8, 0x1
+
+    new-array v8, v8, [Ljava/lang/Class;
+
+    const/4 v9, 0x0
+
+    const-class v10, Ljava/lang/String;
+
+    aput-object v10, v8, v9
+
+    invoke-virtual {v6, v7, v8}, Ljava/lang/Class;->getMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
+
+    move-result-object v6
+
+    const/4 v7, 0x0
+
+    const/4 v8, 0x1
+
+    new-array v8, v8, [Ljava/lang/Object;
+
+    const/4 v9, 0x0
+
+    const-string v10, "window"
+
+    aput-object v10, v8, v9
+
+    invoke-virtual {v6, v7, v8}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
+
+    move-result-object v3
+
+    check-cast v3, Landroid/os/IBinder;
+
+    .line 362
+    .local v3, wmbinder:Landroid/os/IBinder;
+    const-string v6, "android.view.IWindowManager$Stub"
+
+    invoke-static {v6}, Ljava/lang/Class;->forName(Ljava/lang/String;)Ljava/lang/Class;
+
+    move-result-object v6
+
+    const-string v7, "asInterface"
+
+    const/4 v8, 0x1
+
+    new-array v8, v8, [Ljava/lang/Class;
+
+    const/4 v9, 0x0
+
+    const-class v10, Landroid/os/IBinder;
+
+    aput-object v10, v8, v9
+
+    invoke-virtual {v6, v7, v8}, Ljava/lang/Class;->getMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
+
+    move-result-object v6
+
+    const/4 v7, 0x0
+
+    const/4 v8, 0x1
+
+    new-array v8, v8, [Ljava/lang/Object;
+
+    const/4 v9, 0x0
+
+    aput-object v3, v8, v9
+
+    invoke-virtual {v6, v7, v8}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
+
+    move-result-object v2
+
+    .line 363
+    .local v2, windowman:Ljava/lang/Object;
+    const-string v6, "android.view.IWindowManager"
+
+    invoke-static {v6}, Ljava/lang/Class;->forName(Ljava/lang/String;)Ljava/lang/Class;
+
+    move-result-object v6
+
+    const-string v7, "injectKeyEvent"
+
+    const/4 v8, 0x2
+
+    new-array v8, v8, [Ljava/lang/Class;
+
+    const/4 v9, 0x0
+
+    const-class v10, Landroid/view/KeyEvent;
+
+    aput-object v10, v8, v9
+
+    const/4 v9, 0x1
+
+    sget-object v10, Ljava/lang/Boolean;->TYPE:Ljava/lang/Class;
+
+    aput-object v10, v8, v9
+
+    invoke-virtual {v6, v7, v8}, Ljava/lang/Class;->getMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
+
+    move-result-object v1
+
+    .line 365
+    .local v1, injectKeyEvent:Ljava/lang/reflect/Method;
+    const/4 v6, 0x2
+
+    new-array v6, v6, [Ljava/lang/Object;
+
+    const/4 v7, 0x0
+
+    new-instance v8, Landroid/view/KeyEvent;
+
+    const/4 v9, 0x0
+
+    invoke-direct {v8, v9, p1}, Landroid/view/KeyEvent;-><init>(II)V
+
+    aput-object v8, v6, v7
+
+    const/4 v7, 0x1
+
+    const/4 v8, 0x0
+
+    invoke-static {v8}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object v8
+
+    aput-object v8, v6, v7
+
+    invoke-virtual {v1, v2, v6}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
+
+    .line 366
+    const/4 v6, 0x2
+
+    new-array v6, v6, [Ljava/lang/Object;
+
+    const/4 v7, 0x0
+
+    new-instance v8, Landroid/view/KeyEvent;
+
+    const/4 v9, 0x1
+
+    invoke-direct {v8, v9, p1}, Landroid/view/KeyEvent;-><init>(II)V
+
+    aput-object v8, v6, v7
+
+    const/4 v7, 0x1
+
+    const/4 v8, 0x0
+
+    invoke-static {v8}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object v8
+
+    aput-object v8, v6, v7
+
+    invoke-virtual {v1, v2, v6}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
+    :try_end_8e
+    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_8e} :catch_91
+
+    move v4, v5
+
+    .line 373
+    goto/16 :goto_4
+
+    .line 367
+    .end local v1           #injectKeyEvent:Ljava/lang/reflect/Method;
+    .end local v2           #windowman:Ljava/lang/Object;
+    .end local v3           #wmbinder:Landroid/os/IBinder;
+    :catch_91
+    move-exception v0
+
+    .line 368
+    .local v0, e:Ljava/lang/Exception;
+    const-string v5, "NookMod"
+
+    const-string v6, "doKey failed"
+
+    invoke-static {v5, v6}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto/16 :goto_4
+.end method
+
+.method private static doPackage(Landroid/content/Context;Ljava/lang/String;)Z
+    .registers 7
+    .parameter "context"
+    .parameter "command"
+
+    .prologue
+    const/4 v1, 0x0
+
+    .line 320
+    if-eqz p1, :cond_9
+
+    invoke-virtual {p1}, Ljava/lang/String;->length()I
+
+    move-result v2
+
+    if-nez v2, :cond_a
+
+    .line 331
+    :cond_9
+    :goto_9
+    return v1
+
+    .line 325
+    :cond_a
+    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object v2
+
+    invoke-virtual {v2, p1}, Landroid/content/pm/PackageManager;->getLaunchIntentForPackage(Ljava/lang/String;)Landroid/content/Intent;
+
+    move-result-object v0
+
+    .line 326
+    .local v0, intent:Landroid/content/Intent;
+    if-nez v0, :cond_29
+
+    .line 327
+    const-string v2, "NookMod"
+
+    new-instance v3, Ljava/lang/StringBuilder;
+
+    const-string v4, "doPackage() cannot find intent for "
+
+    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v3
+
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v3
+
+    invoke-static {v2, v3}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
+
+    goto :goto_9
+
+    .line 330
+    :cond_29
+    invoke-virtual {p0, v0}, Landroid/content/Context;->startActivity(Landroid/content/Intent;)V
+
+    .line 331
+    const/4 v1, 0x1
+
+    goto :goto_9
+.end method
+
+.method private static doToggleGlowlight(Landroid/content/Context;)Z
+    .registers 9
+    .parameter "context"
+
+    .prologue
+    const/4 v3, 0x1
+
+    const/4 v4, 0x0
+
+    .line 390
+    invoke-static {}, Lcom/android/internal/policy/impl/ModUtils;->getContext()Lcom/android/internal/policy/impl/PhoneWindowManager;
+
+    move-result-object v2
+
+    .line 392
+    .local v2, wms:Lcom/android/internal/policy/impl/PhoneWindowManager;
+    :try_start_6
+    const-string v5, "com.android.internal.policy.impl.PhoneWindowManager"
+
+    invoke-static {v5}, Ljava/lang/Class;->forName(Ljava/lang/String;)Ljava/lang/Class;
+
+    move-result-object v5
+
+    const-string v6, "toggleLights"
+
+    const/4 v7, 0x0
+
+    new-array v7, v7, [Ljava/lang/Class;
+
+    invoke-virtual {v5, v6, v7}, Ljava/lang/Class;->getDeclaredMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
+
+    move-result-object v1
+
+    .line 393
+    .local v1, toggleLights:Ljava/lang/reflect/Method;
+    const/4 v5, 0x1
+
+    invoke-virtual {v1, v5}, Ljava/lang/reflect/Method;->setAccessible(Z)V
+
+    .line 394
+    const/4 v5, 0x0
+
+    new-array v5, v5, [Ljava/lang/Object;
+
+    invoke-virtual {v1, v2, v5}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
+    :try_end_1f
+    .catch Ljava/lang/Exception; {:try_start_6 .. :try_end_1f} :catch_20
+
+    .line 399
+    .end local v1           #toggleLights:Ljava/lang/reflect/Method;
+    :goto_1f
+    return v3
+
+    .line 395
+    :catch_20
+    move-exception v0
+
+    .line 396
+    .local v0, e:Ljava/lang/Exception;
+    const-string v3, "NookMod"
+
+    new-instance v5, Ljava/lang/StringBuilder;
+
+    const-string v6, "toggle light failed "
+
+    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v0}, Ljava/lang/Exception;->toString()Ljava/lang/String;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    const-string v6, "\n"
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v0}, Ljava/lang/Exception;->getCause()Ljava/lang/Throwable;
+
+    move-result-object v6
+
+    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+
+    move-result-object v5
+
+    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-static {v3, v5}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
+
+    move v3, v4
+
+    .line 397
+    goto :goto_1f
+.end method
+
+.method private static doToggleQuicknav(Landroid/content/Context;)Z
+    .registers 7
+    .parameter "context"
+
+    .prologue
+    const/4 v2, 0x0
+
+    .line 377
+    const-string v3, "statusbar"
+
+    invoke-virtual {p0, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+
+    move-result-object v1
+
+    .line 380
+    .local v1, statusbar:Ljava/lang/Object;
+    :try_start_7
+    const-string v3, "android.app.StatusBarManager"
+
+    invoke-static {v3}, Ljava/lang/Class;->forName(Ljava/lang/String;)Ljava/lang/Class;
+
+    move-result-object v3
+
+    const-string v4, "toggleQuickNav"
+
+    const/4 v5, 0x0
+
+    new-array v5, v5, [Ljava/lang/Class;
+
+    invoke-virtual {v3, v4, v5}, Ljava/lang/Class;->getMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
+
+    move-result-object v3
+
+    const/4 v4, 0x0
+
+    new-array v4, v4, [Ljava/lang/Object;
+
+    invoke-virtual {v3, v1, v4}, Ljava/lang/reflect/Method;->invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
+    :try_end_1c
+    .catch Ljava/lang/Exception; {:try_start_7 .. :try_end_1c} :catch_1e
+
+    .line 385
+    const/4 v2, 0x1
+
+    :goto_1d
+    return v2
+
+    .line 381
+    :catch_1e
+    move-exception v0
+
+    .line 383
+    .local v0, e:Ljava/lang/Exception;
+    goto :goto_1d
+.end method
+
+.method private static getButtonBitmap(Landroid/content/Context;Ljava/lang/String;)Landroid/graphics/Bitmap;
+    .registers 11
+    .parameter "context"
+    .parameter "buttonName"
+
+    .prologue
+    const/4 v6, 0x0
+
+    .line 224
+    if-eqz p1, :cond_9
+
+    invoke-virtual {p1}, Ljava/lang/String;->length()I
+
+    move-result v7
+
+    if-nez v7, :cond_a
+
+    .line 249
+    :cond_9
+    :goto_9
+    return-object v6
+
+    .line 227
+    :cond_a
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v5
+
+    .line 228
+    .local v5, resolver:Landroid/content/ContentResolver;
+    new-instance v7, Ljava/lang/StringBuilder;
+
+    const-string v8, "mod."
+
+    invoke-direct {v7, v8}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v7
+
+    const-string v8, ".icon"
+
+    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v7
+
+    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v7
+
+    invoke-static {v5, v7}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v0
+
+    .line 232
+    .local v0, bitmapId:Ljava/lang/String;
+    if-eqz v0, :cond_9
+
+    invoke-virtual {v0}, Ljava/lang/String;->length()I
+
+    move-result v7
+
+    if-eqz v7, :cond_9
+
+    .line 235
+    const-string v7, "^\\d+$"
+
+    invoke-virtual {v0, v7}, Ljava/lang/String;->matches(Ljava/lang/String;)Z
+
+    move-result v7
+
+    if-eqz v7, :cond_44
+
+    .line 237
+    invoke-virtual {p0}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+
+    move-result-object v4
+
+    .line 238
+    .local v4, res:Landroid/content/res/Resources;
+    invoke-static {v0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+
+    move-result v6
+
+    invoke-static {v4, v6}, Landroid/graphics/BitmapFactory;->decodeResource(Landroid/content/res/Resources;I)Landroid/graphics/Bitmap;
+
+    move-result-object v6
+
+    goto :goto_9
+
+    .line 241
+    .end local v4           #res:Landroid/content/res/Resources;
+    :cond_44
+    invoke-virtual {p0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;
+
+    move-result-object v3
+
+    .line 244
+    .local v3, pm:Landroid/content/pm/PackageManager;
+    :try_start_48
+    invoke-virtual {v3, v0}, Landroid/content/pm/PackageManager;->getApplicationIcon(Ljava/lang/String;)Landroid/graphics/drawable/Drawable;
+    :try_end_4b
+    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_48 .. :try_end_4b} :catch_53
+
+    move-result-object v2
+
+    .line 249
+    .local v2, icon:Landroid/graphics/drawable/Drawable;
+    check-cast v2, Landroid/graphics/drawable/BitmapDrawable;
+
+    .end local v2           #icon:Landroid/graphics/drawable/Drawable;
+    invoke-virtual {v2}, Landroid/graphics/drawable/BitmapDrawable;->getBitmap()Landroid/graphics/Bitmap;
+
+    move-result-object v6
+
+    goto :goto_9
+
+    .line 245
+    :catch_53
+    move-exception v1
+
+    .line 246
+    .local v1, e:Landroid/content/pm/PackageManager$NameNotFoundException;
+    goto :goto_9
+.end method
+
+.method private static getButtonLabel(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;
+    .registers 5
+    .parameter "context"
+    .parameter "buttonName"
+
+    .prologue
+    .line 254
+    if-eqz p1, :cond_8
+
+    invoke-virtual {p1}, Ljava/lang/String;->length()I
+
+    move-result v1
+
+    if-nez v1, :cond_a
+
+    .line 255
+    :cond_8
+    const/4 v1, 0x0
+
+    .line 258
+    :goto_9
+    return-object v1
+
+    .line 257
+    :cond_a
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v0
+
+    .line 258
+    .local v0, resolver:Landroid/content/ContentResolver;
+    new-instance v1, Ljava/lang/StringBuilder;
+
+    const-string v2, "mod."
+
+    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    const-string v2, ".label"
+
+    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v1
+
+    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v1
+
+    invoke-static {v0, v1}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v1
+
+    goto :goto_9
+.end method
+
+.method private static getButtonName(I)Ljava/lang/String;
+    .registers 2
+    .parameter "id"
+
+    .prologue
+    .line 62
+    sparse-switch p0, :sswitch_data_26
+
+    .line 76
+    const/4 v0, 0x0
+
+    :goto_4
+    return-object v0
+
+    .line 64
+    :sswitch_5
+    const-string v0, "quicknav.1"
+
+    goto :goto_4
+
+    .line 65
+    :sswitch_8
+    const-string v0, "quicknav.2"
+
+    goto :goto_4
+
+    .line 66
+    :sswitch_b
+    const-string v0, "quicknav.3"
+
+    goto :goto_4
+
+    .line 67
+    :sswitch_e
+    const-string v0, "quicknav.4"
+
+    goto :goto_4
+
+    .line 68
+    :sswitch_11
+    const-string v0, "quicknav.5"
+
+    goto :goto_4
+
+    .line 69
+    :sswitch_14
+    const-string v0, "quicknav.6"
+
+    goto :goto_4
+
+    .line 70
+    :sswitch_17
+    const-string v0, "statusbar.back"
+
+    goto :goto_4
+
+    .line 71
+    :sswitch_1a
+    const-string v0, "statusbar.menu"
+
+    goto :goto_4
+
+    .line 72
+    :sswitch_1d
+    const-string v0, "statusbar.readnow"
+
+    goto :goto_4
+
+    .line 73
+    :sswitch_20
+    const-string v0, "statusbar.notify"
+
+    goto :goto_4
+
+    .line 74
+    :sswitch_23
+    const-string v0, "statusbar.glowlight"
+
+    goto :goto_4
+
+    .line 62
+    :sswitch_data_26
+    .sparse-switch
+        0x1020196 -> :sswitch_5
+        0x1020197 -> :sswitch_8
+        0x1020198 -> :sswitch_b
+        0x1020199 -> :sswitch_e
+        0x102019a -> :sswitch_11
+        0x102019b -> :sswitch_14
+        0x1020220 -> :sswitch_17
+        0x1020221 -> :sswitch_1a
+        0x1020222 -> :sswitch_1d
+        0x1020223 -> :sswitch_20
+        0x1020225 -> :sswitch_23
+    .end sparse-switch
+.end method
+
+.method private static getIntentFromString(Ljava/lang/String;)Landroid/content/Intent;
+    .registers 10
+    .parameter "intentStr"
+
+    .prologue
+    const/16 v8, 0x9
+
+    const/4 v7, 0x6
+
+    const/4 v6, 0x0
+
+    .line 298
+    const-string v3, ";"
+
+    invoke-virtual {p0, v3}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;
+
+    move-result-object v0
+
+    .line 299
+    .local v0, chunk:[Ljava/lang/String;
+    new-instance v2, Landroid/content/Intent;
+
+    aget-object v3, v0, v6
+
+    invoke-direct {v2, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V
+
+    .line 300
+    .local v2, intent:Landroid/content/Intent;
+    const-string v3, "NookMod"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string v5, "new intent: "
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    aget-object v5, v0, v6
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v3, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
+
+    .line 302
+    const/4 v1, 0x1
+
+    .local v1, i:I
+    :goto_28
+    array-length v3, v0
+
+    if-lt v1, v3, :cond_2c
+
+    .line 316
+    return-object v2
+
+    .line 304
+    :cond_2c
+    aget-object v3, v0, v1
+
+    const-string v4, "CATEGORY:"
+
+    invoke-virtual {v3, v4}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
+
+    move-result v3
+
+    if-eqz v3, :cond_59
+
+    .line 306
+    const-string v3, "NookMod"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string v5, "intent - adding category: "
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    aget-object v5, v0, v1
+
+    invoke-virtual {v5, v8}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v3, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
+
+    .line 307
+    aget-object v3, v0, v1
+
+    invoke-virtual {v3, v8}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v3
+
+    invoke-virtual {v2, v3}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;
+
+    .line 310
+    :cond_59
+    aget-object v3, v0, v1
+
+    const-string v4, "FLAGS:"
+
+    invoke-virtual {v3, v4}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z
+
+    move-result v3
+
+    if-eqz v3, :cond_8a
+
+    .line 312
+    const-string v3, "NookMod"
+
+    new-instance v4, Ljava/lang/StringBuilder;
+
+    const-string v5, "intent - adding flags: "
+
+    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    aget-object v5, v0, v1
+
+    invoke-virtual {v5, v7}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v5
+
+    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v4
+
+    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-static {v3, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
+
+    .line 313
+    aget-object v3, v0, v1
+
+    invoke-virtual {v3, v7}, Ljava/lang/String;->substring(I)Ljava/lang/String;
+
+    move-result-object v3
+
+    invoke-static {v3}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+
+    move-result v3
+
+    invoke-virtual {v2, v3}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;
+
+    .line 302
+    :cond_8a
+    add-int/lit8 v1, v1, 0x1
+
+    goto :goto_28
+.end method
+
+.method public static getVersion()Ljava/lang/String;
+    .registers 1
+
+    .prologue
+    .line 59
+    const-string v0, "0.2.0"
+
+    return-object v0
+.end method
+
+.method public static onScreenResume(Landroid/content/Context;)V
+    .registers 3
+    .parameter "context"
+
+    .prologue
+    .line 129
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v0
+
+    .line 131
+    .local v0, resolver:Landroid/content/ContentResolver;
+    :try_start_4
+    const-string v1, "mod.option.restore_glowlight_on_wake"
+
+    invoke-static {v0, v1}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;)I
+
+    move-result v1
+
+    if-lez v1, :cond_17
+
+    .line 132
+    const-string v1, "mod.misc.wake_screen_brightness_mode"
+
+    invoke-static {v0, v1}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;)I
+
+    move-result v1
+
+    if-lez v1, :cond_17
+
+    .line 133
+    invoke-static {p0}, Lcom/android/server/status/ModUtils;->doToggleGlowlight(Landroid/content/Context;)Z
+    :try_end_17
+    .catch Landroid/provider/Settings$SettingNotFoundException; {:try_start_4 .. :try_end_17} :catch_18
+
+    .line 136
+    :cond_17
+    :goto_17
+    return-void
+
+    .line 134
+    :catch_18
+    move-exception v1
+
+    goto :goto_17
+.end method
+
+.method public static onScreenSleep(Landroid/content/Context;)V
+    .registers 4
+    .parameter "context"
+
+    .prologue
+    .line 116
+    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v1
+
+    .line 118
+    .local v1, resolver:Landroid/content/ContentResolver;
+    :try_start_4
+    const-string v2, "mod.option.restore_glowlight_on_wake"
+
+    invoke-static {v1, v2}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;)I
+
+    move-result v2
+
+    if-lez v2, :cond_17
+
+    .line 119
+    const-string v2, "screen_brightness_mode"
+
+    invoke-static {v1, v2}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v0
+
+    .line 120
+    .local v0, lightStatus:Ljava/lang/String;
+    const-string v2, "mod.misc.wake_screen_brightness_mode"
+
+    invoke-static {v1, v2, v0}, Landroid/provider/Settings$System;->putString(Landroid/content/ContentResolver;Ljava/lang/String;Ljava/lang/String;)Z
+    :try_end_17
+    .catch Landroid/provider/Settings$SettingNotFoundException; {:try_start_4 .. :try_end_17} :catch_18
+
+    .line 125
+    .end local v0           #lightStatus:Ljava/lang/String;
+    :cond_17
+    :goto_17
+    return-void
+
+    .line 123
+    :catch_18
+    move-exception v2
+
+    goto :goto_17
+.end method
+
+.method public static overrideShopButton(Landroid/content/Context;)Ljava/lang/Boolean;
+    .registers 2
+    .parameter "context"
+
+    .prologue
+    .line 140
+    const-string v0, "QUICKNAV_SHOP"
+
+    invoke-static {p0, v0}, Lcom/android/server/status/ModUtils;->getButtonBitmap(Landroid/content/Context;Ljava/lang/String;)Landroid/graphics/Bitmap;
+
+    move-result-object v0
+
+    if-eqz v0, :cond_e
+
+    const/4 v0, 0x1
+
+    invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object v0
+
+    :goto_d
+    return-object v0
+
+    :cond_e
+    const/4 v0, 0x0
+
+    invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;
+
+    move-result-object v0
+
+    goto :goto_d
+.end method
+
+.method public static replaceQuicknavIcon(Landroid/content/Context;Landroid/widget/ImageView;)V
+    .registers 30
+    .parameter "context"
+    .parameter "view"
+    .annotation system Ldalvik/annotation/Throws;
+        value = {
+            Landroid/content/pm/PackageManager$NameNotFoundException;
+        }
+    .end annotation
+
+    .prologue
+    .line 145
+    if-eqz p1, :cond_8
+
+    invoke-virtual/range {p1 .. p1}, Landroid/widget/ImageView;->getId()I
+
+    move-result v3
+
+    if-nez v3, :cond_9
+
+    .line 220
+    :cond_8
+    :goto_8
+    return-void
+
+    .line 148
+    :cond_9
+    invoke-virtual/range {p1 .. p1}, Landroid/widget/ImageView;->getId()I
+
+    move-result v3
+
+    invoke-static {v3}, Lcom/android/server/status/ModUtils;->getButtonName(I)Ljava/lang/String;
+
+    move-result-object v11
+
+    .line 149
+    .local v11, buttonName:Ljava/lang/String;
+    if-eqz v11, :cond_8
+
+    invoke-virtual {v11}, Ljava/lang/String;->length()I
+
+    move-result v3
+
+    if-eqz v3, :cond_8
+
+    .line 154
+    move-object/from16 v0, p0
+
+    invoke-static {v0, v11}, Lcom/android/server/status/ModUtils;->getButtonBitmap(Landroid/content/Context;Ljava/lang/String;)Landroid/graphics/Bitmap;
+
+    move-result-object v16
+
+    .line 155
+    .local v16, icon:Landroid/graphics/Bitmap;
+    move-object/from16 v0, p0
+
+    invoke-static {v0, v11}, Lcom/android/server/status/ModUtils;->getButtonLabel(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v17
+
+    .line 157
+    .local v17, iconLabel:Ljava/lang/String;
+    if-eqz v17, :cond_2d
+
+    invoke-virtual/range {v17 .. v17}, Ljava/lang/String;->length()I
+
+    move-result v3
+
+    if-nez v3, :cond_2f
+
+    :cond_2d
+    if-eqz v16, :cond_8
+
+    .line 160
+    :cond_2f
+    const-string v3, "window"
+
+    move-object/from16 v0, p0
+
+    invoke-virtual {v0, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
+
+    move-result-object v27
+
+    check-cast v27, Landroid/view/WindowManager;
+
+    .line 161
+    .local v27, wm:Landroid/view/WindowManager;
+    invoke-interface/range {v27 .. v27}, Landroid/view/WindowManager;->getDefaultDisplay()Landroid/view/Display;
+
+    move-result-object v13
+
+    .line 163
+    .local v13, display:Landroid/view/Display;
+    invoke-virtual/range {p0 .. p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v25
+
+    .line 164
+    .local v25, resolver:Landroid/content/ContentResolver;
+    const-string v3, "has_glowlight"
+
+    move-object/from16 v0, v25
+
+    invoke-static {v0, v3}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;
+
+    move-result-object v3
+
+    invoke-static {v3}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+
+    move-result v3
+
+    if-lez v3, :cond_12b
+
+    const/4 v8, 0x1
+
+    .line 165
+    .local v8, bHasGlowlight:Z
+    :goto_50
+    if-eqz v8, :cond_12e
+
+    const/4 v9, 0x6
+
+    .line 166
+    .local v9, buttonCount:I
+    :goto_53
+    invoke-virtual {v13}, Landroid/view/Display;->getWidth()I
+
+    move-result v3
+
+    div-int v12, v3, v9
+
+    .line 167
+    .local v12, buttonWidth:I
+    const/16 v10, 0x70
+
+    .line 169
+    .local v10, buttonHeight:I
+    const/16 v19, 0x56
+
+    .line 170
+    .local v19, labelOffsetY:I
+    const/16 v18, 0x60
+
+    .line 172
+    .local v18, iconOffsetY:I
+    new-instance v2, Landroid/graphics/Canvas;
+
+    invoke-direct {v2}, Landroid/graphics/Canvas;-><init>()V
+
+    .line 173
+    .local v2, canvas:Landroid/graphics/Canvas;
+    new-instance v7, Landroid/graphics/Paint;
+
+    invoke-direct {v7}, Landroid/graphics/Paint;-><init>()V
+
+    .line 174
+    .local v7, paint:Landroid/graphics/Paint;
+    const/high16 v3, -0x100
+
+    invoke-virtual {v7, v3}, Landroid/graphics/Paint;->setColor(I)V
+
+    .line 176
+    sget-object v3, Landroid/graphics/Bitmap$Config;->RGB_565:Landroid/graphics/Bitmap$Config;
+
+    invoke-static {v12, v10, v3}, Landroid/graphics/Bitmap;->createBitmap(IILandroid/graphics/Bitmap$Config;)Landroid/graphics/Bitmap;
+
+    move-result-object v22
+
+    .line 177
+    .local v22, newBitmap:Landroid/graphics/Bitmap;
+    move-object/from16 v0, v22
+
+    invoke-virtual {v2, v0}, Landroid/graphics/Canvas;->setBitmap(Landroid/graphics/Bitmap;)V
+
+    .line 179
+    const/4 v3, -0x1
+
+    invoke-virtual {v2, v3}, Landroid/graphics/Canvas;->drawColor(I)V
+
+    .line 181
+    const/high16 v3, 0x4140
+
+    invoke-virtual {v7, v3}, Landroid/graphics/Paint;->setStrokeWidth(F)V
+
+    .line 182
+    const/4 v3, 0x0
+
+    const/4 v4, 0x0
+
+    add-int/lit8 v5, v12, -0x1
+
+    int-to-float v5, v5
+
+    const/4 v6, 0x0
+
+    invoke-virtual/range {v2 .. v7}, Landroid/graphics/Canvas;->drawLine(FFFFLandroid/graphics/Paint;)V
+
+    .line 184
+    const/high16 v3, 0x3f80
+
+    invoke-virtual {v7, v3}, Landroid/graphics/Paint;->setStrokeWidth(F)V
+
+    .line 185
+    invoke-virtual/range {p1 .. p1}, Landroid/widget/ImageView;->getId()I
+
+    move-result v3
+
+    const v4, 0x102019a
+
+    if-eq v3, v4, :cond_a4
+
+    .line 186
+    add-int/lit8 v3, v12, -0x1
+
+    int-to-float v3, v3
+
+    const/4 v4, 0x0
+
+    add-int/lit8 v5, v12, -0x1
+
+    int-to-float v5, v5
+
+    int-to-float v6, v10
+
+    invoke-virtual/range {v2 .. v7}, Landroid/graphics/Canvas;->drawLine(FFFFLandroid/graphics/Paint;)V
+
+    .line 188
+    :cond_a4
+    if-eqz v16, :cond_c9
+
+    .line 189
+    invoke-virtual/range {v22 .. v22}, Landroid/graphics/Bitmap;->getWidth()I
+
+    move-result v3
+
+    invoke-virtual/range {v16 .. v16}, Landroid/graphics/Bitmap;->getWidth()I
+
+    move-result v4
+
+    sub-int/2addr v3, v4
+
+    div-int/lit8 v23, v3, 0x2
+
+    .line 190
+    .local v23, offsetX:I
+    invoke-virtual/range {v16 .. v16}, Landroid/graphics/Bitmap;->getHeight()I
+
+    move-result v3
+
+    sub-int v3, v18, v3
+
+    div-int/lit8 v24, v3, 0x2
+
+    .line 191
+    .local v24, offsetY:I
+    if-gez v24, :cond_bd
+
+    .line 192
+    const/16 v24, 0x0
+
+    .line 193
+    :cond_bd
+    move/from16 v0, v23
+
+    int-to-float v3, v0
+
+    move/from16 v0, v24
+
+    int-to-float v4, v0
+
+    const/4 v5, 0x0
+
+    move-object/from16 v0, v16
+
+    invoke-virtual {v2, v0, v3, v4, v5}, Landroid/graphics/Canvas;->drawBitmap(Landroid/graphics/Bitmap;FFLandroid/graphics/Paint;)V
+
+    .line 196
+    .end local v23           #offsetX:I
+    .end local v24           #offsetY:I
+    :cond_c9
+    if-eqz v17, :cond_122
+
+    invoke-virtual/range {v17 .. v17}, Ljava/lang/String;->length()I
+
+    move-result v3
+
+    if-lez v3, :cond_122
+
+    .line 198
+    sget-object v3, Landroid/graphics/Typeface;->DEFAULT:Landroid/graphics/Typeface;
+
+    invoke-virtual {v7, v3}, Landroid/graphics/Paint;->setTypeface(Landroid/graphics/Typeface;)Landroid/graphics/Typeface;
+
+    .line 199
+    sget-object v3, Landroid/graphics/Paint$Align;->CENTER:Landroid/graphics/Paint$Align;
+
+    invoke-virtual {v7, v3}, Landroid/graphics/Paint;->setTextAlign(Landroid/graphics/Paint$Align;)V
+
+    .line 200
+    const/high16 v3, 0x41a0
+
+    invoke-virtual {v7, v3}, Landroid/graphics/Paint;->setTextSize(F)V
+
+    .line 201
+    const/4 v3, 0x1
+
+    invoke-virtual {v7, v3}, Landroid/graphics/Paint;->setFlags(I)V
+
+    .line 203
+    move-object/from16 v0, v17
+
+    invoke-virtual {v7, v0}, Landroid/graphics/Paint;->measureText(Ljava/lang/String;)F
+
+    move-result v26
+
+    .line 204
+    .local v26, tWidth:F
+    int-to-float v3, v12
+
+    cmpl-float v3, v26, v3
+
+    if-lez v3, :cond_117
+
+    .line 205
+    const-string v15, "\u2026"
+
+    .line 206
+    .local v15, ellipsis:Ljava/lang/String;
+    invoke-virtual {v7, v15}, Landroid/graphics/Paint;->measureText(Ljava/lang/String;)F
+
+    move-result v14
+
+    .line 208
+    .local v14, eWidth:F
+    invoke-virtual/range {v17 .. v17}, Ljava/lang/String;->length()I
+
+    move-result v20
+
+    .local v20, len:I
+    move/from16 v21, v20
+
+    .line 209
+    .end local v20           #len:I
+    .local v21, len:I
+    :goto_fb
+    add-float v3, v26, v14
+
+    int-to-float v4, v12
+
+    cmpl-float v3, v3, v4
+
+    if-ltz v3, :cond_143
+
+    add-int/lit8 v20, v21, -0x1
+
+    .end local v21           #len:I
+    .restart local v20       #len:I
+    if-gtz v21, :cond_131
+
+    .line 213
+    :goto_106
+    new-instance v3, Ljava/lang/StringBuilder;
+
+    invoke-static/range {v17 .. v17}, Ljava/lang/String;->valueOf(Ljava/lang/Object;)Ljava/lang/String;
+
+    move-result-object v4
+
+    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V
+
+    invoke-virtual {v3, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+
+    move-result-object v3
+
+    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+
+    move-result-object v17
+
+    .line 216
+    .end local v14           #eWidth:F
+    .end local v15           #ellipsis:Ljava/lang/String;
+    .end local v20           #len:I
+    :cond_117
+    div-int/lit8 v3, v12, 0x2
+
+    int-to-float v3, v3
+
+    move/from16 v0, v19
+
+    int-to-float v4, v0
+
+    move-object/from16 v0, v17
+
+    invoke-virtual {v2, v0, v3, v4, v7}, Landroid/graphics/Canvas;->drawText(Ljava/lang/String;FFLandroid/graphics/Paint;)V
+
+    .line 219
+    .end local v26           #tWidth:F
+    :cond_122
+    move-object/from16 v0, p1
+
+    move-object/from16 v1, v22
+
+    invoke-virtual {v0, v1}, Landroid/widget/ImageView;->setImageBitmap(Landroid/graphics/Bitmap;)V
+
+    goto/16 :goto_8
+
+    .line 164
+    .end local v2           #canvas:Landroid/graphics/Canvas;
+    .end local v7           #paint:Landroid/graphics/Paint;
+    .end local v8           #bHasGlowlight:Z
+    .end local v9           #buttonCount:I
+    .end local v10           #buttonHeight:I
+    .end local v12           #buttonWidth:I
+    .end local v18           #iconOffsetY:I
+    .end local v19           #labelOffsetY:I
+    .end local v22           #newBitmap:Landroid/graphics/Bitmap;
+    :cond_12b
+    const/4 v8, 0x0
+
+    goto/16 :goto_50
+
+    .line 165
+    .restart local v8       #bHasGlowlight:Z
+    :cond_12e
+    const/4 v9, 0x5
+
+    goto/16 :goto_53
+
+    .line 210
+    .restart local v2       #canvas:Landroid/graphics/Canvas;
+    .restart local v7       #paint:Landroid/graphics/Paint;
+    .restart local v9       #buttonCount:I
+    .restart local v10       #buttonHeight:I
+    .restart local v12       #buttonWidth:I
+    .restart local v14       #eWidth:F
+    .restart local v15       #ellipsis:Ljava/lang/String;
+    .restart local v18       #iconOffsetY:I
+    .restart local v19       #labelOffsetY:I
+    .restart local v20       #len:I
+    .restart local v22       #newBitmap:Landroid/graphics/Bitmap;
+    .restart local v26       #tWidth:F
+    :cond_131
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v17
+
+    move/from16 v1, v20
+
+    invoke-virtual {v0, v3, v1}, Ljava/lang/String;->substring(II)Ljava/lang/String;
+
+    move-result-object v17
+
+    .line 211
+    move-object/from16 v0, v17
+
+    invoke-virtual {v7, v0}, Landroid/graphics/Paint;->measureText(Ljava/lang/String;)F
+
+    move-result v26
+
+    move/from16 v21, v20
+
+    .end local v20           #len:I
+    .restart local v21       #len:I
+    goto :goto_fb
+
+    :cond_143
+    move/from16 v20, v21
+
+    .end local v21           #len:I
+    .restart local v20       #len:I
+    goto :goto_106
+.end method
diff --git a/com/android/server/status/StatusBarService.smali b/com/android/server/status/StatusBarService.smali
index 4bc92d2..e9ae737 100644
--- a/com/android/server/status/StatusBarService.smali
+++ b/com/android/server/status/StatusBarService.smali
@@ -2284,6 +2284,24 @@
     .parameter "action"
 
     .prologue
+
+### Mod Start
+###
+###   Always show back and menu buttons in statusbar
+###
+    iget-object v0, p0, Lcom/android/server/status/StatusBarService;->mContext:Landroid/content/Context;
+    invoke-static {v0}, Lcom/android/server/status/ModUtils;->alwaysShowStatusIcons(Landroid/content/Context;)Z
+
+    move-result v0
+    if-eqz v0, :cond_NoMod
+
+    const/4 v1, 0x0
+    move v0, v1
+	goto :goto_4
+
+    :cond_NoMod
+### Mod End
+    
     .line 1997
     if-nez p1, :cond_13
 
@@ -4629,6 +4647,23 @@
     .local v1, id:I
     iget-object v5, p0, Lcom/android/server/status/StatusBarService;->mContext:Landroid/content/Context;
 
+### Mod Start
+###
+### Override status bar buttons
+### This should run near the start of onQuicknavButtonClick()
+### after getId() is read into v1 and context is read into v5
+###
+### if ( ModUtils.OnButtonClick( StatusBarService.mContext, buttonId ) )
+###   return;
+
+    invoke-static {v5, v1}, Lcom/android/server/status/ModUtils;->OnButtonClick(Landroid/content/Context;I)Z
+
+    move-result v0
+    if-eqz v0, :cond_mod1
+    return-void
+    :cond_mod1
+### Mod End
+
     const-string v6, "statusbar"
 
     invoke-virtual {v5, v6}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;
